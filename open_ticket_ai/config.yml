$schema: "./config.schema.json"

open_ticket_ai:

  # only one ticket‚Äêsystem_id adapter
  system:
    provider_key: "OTOBOAdapter"
    params:
      server_address: "http://18.193.56.84"
      webservice_name: "OTAI"
      search_operation_url: "ticket/search"
      update_operation_url: "ticket"
      get_operation_url: "ticket/get"
      username: "root@locallhost"
      password_env_var: "OTOBOPASS"
  fetchers:
    - id: "basic_ticket"
      provider_key: "BasicTicketFetcher"
      params:
        filters:
          - attribute: "queue"
            value: "incoming_queue"

  data_preparers:
    - id: "subject_body"
      provider_key: "SubjectBodyPreparer"
      params:
        subject_field: "subject"
        body_field: "body"
        repeat_subject: 3

  ai_inference_services:
    - id: "queue_model"
      provider_key: "HFAIInferenceService"
      params:
        hf_model: "open-ticket-ai/queue-classification-german-bert"
        hf_token_env_var: "HUGGINGFACE_TOKEN"

    - id: "priority_model"
      provider_key: "HFAIInferenceService"
      params:
        hf_model: "open-ticket-ai/priority-classification-german-bert"
        hf_token_env_var: "HUGGINGFACE_TOKEN"


  modifiers:
    - id: "queue_updater"
      provider_key: "QueueModifier"
      params:
        confidence_threshold: 0.8
        low_confidence_value: "unclassified"
    - id: "priority_updater"
      provider_key: "PriorityModifier"
      params:
        confidence_threshold: 0.6
        low_confidence_value: 3

  attribute_predictors:
    - id: "queue_classification"
      provider_key: "QueuePredictor"
      fetcher_id: "basic_ticket"
      preparer_id: "subject_body"
      ai_inference_service_id: "queue_model"
      modifier_id: "queue_updater"
      schedule:
        interval: 10
        unit: "seconds"
      params:
        ticket_system_value2model_values:
          otobo_queue1:
            - "IT & Technology/Security Operations"
          otobo_queue2:
            - "IT & Technology/Software Development"
          research_development:
            - "Science/*"
          misc:
            - "*"

    - id: "priority_classification"
      provider_key: "PriorityPredictor"
      fetcher_id: "basic_ticket"
      preparer_id: "subject_body"
      ai_inference_service_id: "priority_model"
      modifier_id: "priority_updater"
      schedule:
        interval: 10
        unit: "seconds"
      params:
        ticket_system_value2model_values:
          1: [ 1 ]
          2: [ 2 ]
          3: [ 3 ]
          4: [ 4 ]
          5: [ 5 ]